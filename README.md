# VBA Excel 处理工具集
各种VBA处理Excel的实用工具和函数库

## 📋 项目简介

这个项目提供了一套完整的VBA工具集，用于自动化处理Excel文件。包含数据处理、文件操作、格式化、数据分析和工作表管理等多个模块。

## 🚀 功能模块

### 1. 数据处理模块 (DataManipulation.bas)
提供各种数据处理和清洗功能：
- **删除重复行** - 根据指定列删除重复数据
- **数据清洗** - 去除单元格中的空白字符
- **批量替换** - 在指定范围内批量替换文本
- **数据分列** - 按分隔符将数据分列
- **合并列数据** - 将多列数据合并为一列
- **提取数字/中文** - 从文本中提取数字或中文字符
- **数据转置** - 行列转换

### 2. 文件操作模块 (FileOperations.bas)
处理文件导入导出和工作簿操作：
- **导出CSV** - 将工作表导出为CSV文件
- **导入CSV** - 从CSV文件导入数据
- **批量导入Excel文件** - 将文件夹中的所有Excel文件合并
- **拆分工作簿** - 按指定列的值拆分成多个文件
- **合并工作簿** - 将多个工作簿合并为一个
- **备份工作簿** - 创建带时间戳的备份文件

### 3. 格式化工具模块 (FormattingUtilities.bas)
提供单元格格式化和样式设置功能：
- **自动调整列宽** - 根据内容自动调整列宽
- **添加表格边框** - 为范围添加边框
- **隔行填充颜色** - 创建斑马纹效果
- **创建标准表格** - 一键创建标准格式的表格
- **突出显示重复值** - 用颜色标记重复的数据
- **颜色渐变** - 根据数值应用颜色渐变
- **数字格式设置** - 货币、百分比、日期等格式
- **字体和对齐** - 批量设置字体和对齐方式

### 4. 数据分析模块 (DataAnalysis.bas)
提供数据统计和分析功能：
- **统计信息** - 计算总和、平均值、最大最小值等
- **创建数据透视表** - 自动生成数据透视表
- **数据分组** - 按列值对数据进行分组
- **计算增长率** - 计算同比环比增长率
- **查找异常值** - 使用IQR方法识别异常数据
- **移动平均** - 计算指定周期的移动平均值
- **去重统计** - 统计唯一值数量
- **频率分布** - 创建频率分布表
- **数据排名** - 对数据进行排名

### 5. 工作表工具模块 (WorksheetUtilities.bas)
管理和操作工作表：
- **批量创建工作表** - 一次创建多个工作表
- **删除空白工作表** - 清理空工作表
- **复制工作表** - 复制到新工作簿
- **隐藏/显示工作表** - 批量隐藏或显示
- **工作表排序** - 按名称排序工作表
- **保护/取消保护** - 批量保护所有工作表
- **创建目录** - 为所有工作表创建导航目录
- **批量重命名** - 为工作表添加统一前缀

## 📦 安装使用

### 方法一：直接导入模块
1. 打开Excel文件
2. 按 `Alt + F11` 打开VBA编辑器
3. 在项目浏览器中右键点击你的工作簿
4. 选择 `文件` > `导入文件...`
5. 选择需要的 `.bas` 文件导入

### 方法二：复制代码
1. 打开 `.bas` 文件
2. 复制所需的函数或子程序
3. 在VBA编辑器中创建新模块
4. 粘贴代码

## 💡 使用示例

### 示例 1：删除重复行
```vba
Sub Example_RemoveDuplicates()
    Dim ws As Worksheet
    Set ws = ActiveSheet
    
    ' 删除A1:E100范围内第1列的重复值
    Call RemoveDuplicateRows(ws.Range("A1:E100"), 1)
End Sub
```

### 示例 2：导出为CSV
```vba
Sub Example_ExportCSV()
    Dim ws As Worksheet
    Set ws = ActiveSheet
    
    Call ExportToCSV(ws, "C:\导出数据\output.csv")
End Sub
```

### 示例 3：创建标准表格
```vba
Sub Example_CreateTable()
    Dim rng As Range
    Set rng = ActiveSheet.Range("A1:E10")
    
    Call CreateStandardTable(rng)
End Sub
```

### 示例 4：数据统计
```vba
Sub Example_GetStats()
    Dim rng As Range
    Dim stats As String
    
    Set rng = ActiveSheet.Range("A1:A100")
    stats = GetRangeStatistics(rng)
    
    MsgBox stats
End Sub
```

### 示例 5：批量导入文件
```vba
Sub Example_ImportFiles()
    Dim ws As Worksheet
    Set ws = ActiveSheet
    
    Call ImportAllExcelFiles("C:\数据文件夹\", ws)
End Sub
```

## 🔧 系统要求

- Microsoft Excel 2010 或更高版本
- 启用宏功能
- Windows 或 Mac (某些功能可能在Mac上有限制)

## ⚙️ 启用宏

1. 打开Excel
2. 点击 `文件` > `选项` > `信任中心` > `信任中心设置`
3. 选择 `宏设置`
4. 选择 `启用所有宏` 或 `禁用无数字签名的宏`

## 📝 注意事项

- 在使用删除、清空等操作前，建议先备份数据
- 某些功能需要 `Microsoft Scripting Runtime` 引用（字典对象）
- 处理大量数据时，程序会自动关闭屏幕更新以提高性能
- 文件操作需要确保有足够的磁盘空间和访问权限

## 🤝 贡献

欢迎提交问题和改进建议！

## 📄 许可证

本项目采用 MIT 许可证

## 📞 联系方式

如有问题或建议，请创建 Issue

## 🔄 更新日志

### 版本 1.0.0 (2025-10-16)
- 初始版本发布
- 包含5个核心模块
- 提供50+实用函数和子程序

---

**提示**: 使用前请先在测试文件上验证功能，确保符合您的需求。
